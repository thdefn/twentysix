FROM openjdk:22
ARG JAR_FILE=user/build/libs/user-0.0.1-SNAPSHOT.jar

ARG DB_URL
ARG DB_PASSWORD
ARG REDIS_HOST
ARG REDIS_PASSWORD
ARG KAFKA_BROKERS
ARG MAILGUN_URL
ARG MAILGUN_KEY

ENV DB_URL=${DB_URL}
ENV DB_PASSWORD=${DB_PASSWORD}
ENV REDIS_HOST=${REDIS_HOST}
ENV REDIS_PASSWORD=${REDIS_PASSWORD}
ENV KAFKA_BROKERS=${KAFKA_BROKERS}
ENV MAILGUN_URL=${MAILGUN_URL}
ENV MAILGUN_KEY=${MAILGUN_KEY}

COPY ${JAR_FILE} /app.jar
ENTRYPOINT ["java","-Duser.timezone=Asia/Seoul", "-Dspring.profiles.active=test","-jar","/app.jar"]